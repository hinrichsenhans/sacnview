<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>WinPcap: __CPU_Private_Data Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WinPcap
   &#160;<span id="projectnumber">4.1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">__CPU_Private_Data Struct Reference<div class="ingroups"><a class="el" href="group__internals.html">WinPcap internals</a> &raquo; <a class="el" href="group__NPF.html">NPF driver internals manual</a> &raquo; <a class="el" href="group__NPF__include.html">NPF structures and definitions</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Kernel buffer of each CPU.  
 <a href="struct____CPU__Private__Data.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Packet_8h_source.html">Packet.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a897d2179904e0d6fafd73b3d400052de"><td class="memItemLeft" align="right" valign="top">ULONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a897d2179904e0d6fafd73b3d400052de">P</a></td></tr>
<tr class="memdesc:a897d2179904e0d6fafd73b3d400052de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero-based index of the producer in the buffer. It indicates the first free byte to be written.  <a href="#a897d2179904e0d6fafd73b3d400052de">More...</a><br /></td></tr>
<tr class="separator:a897d2179904e0d6fafd73b3d400052de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2df61425b58c12f1de6f0e6aaeb131ea"><td class="memItemLeft" align="right" valign="top">ULONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a2df61425b58c12f1de6f0e6aaeb131ea">C</a></td></tr>
<tr class="memdesc:a2df61425b58c12f1de6f0e6aaeb131ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero-based index of the consumer in the buffer. It indicates the first free byte to be read.  <a href="#a2df61425b58c12f1de6f0e6aaeb131ea">More...</a><br /></td></tr>
<tr class="separator:a2df61425b58c12f1de6f0e6aaeb131ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf5ef1e959170b06d01fc65a27bb951"><td class="memItemLeft" align="right" valign="top">ULONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#acaf5ef1e959170b06d01fc65a27bb951">Free</a></td></tr>
<tr class="memdesc:acaf5ef1e959170b06d01fc65a27bb951"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of the free bytes in the buffer.  <a href="#acaf5ef1e959170b06d01fc65a27bb951">More...</a><br /></td></tr>
<tr class="separator:acaf5ef1e959170b06d01fc65a27bb951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed9f5e612c567cfa25af0f46a25dad4"><td class="memItemLeft" align="right" valign="top">PUCHAR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a7ed9f5e612c567cfa25af0f46a25dad4">Buffer</a></td></tr>
<tr class="memdesc:a7ed9f5e612c567cfa25af0f46a25dad4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the kernel buffer used to capture packets.  <a href="#a7ed9f5e612c567cfa25af0f46a25dad4">More...</a><br /></td></tr>
<tr class="separator:a7ed9f5e612c567cfa25af0f46a25dad4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac723ebbda9ff2ef8e4d773c7305db1f6"><td class="memItemLeft" align="right" valign="top">ULONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#ac723ebbda9ff2ef8e4d773c7305db1f6">Accepted</a></td></tr>
<tr class="separator:ac723ebbda9ff2ef8e4d773c7305db1f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82febc79f3f3bbf857a4fd34447b5ca2"><td class="memItemLeft" align="right" valign="top">ULONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a82febc79f3f3bbf857a4fd34447b5ca2">Received</a></td></tr>
<tr class="separator:a82febc79f3f3bbf857a4fd34447b5ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04eecb86252e644a73f38346274340dc"><td class="memItemLeft" align="right" valign="top">ULONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a04eecb86252e644a73f38346274340dc">Dropped</a></td></tr>
<tr class="separator:a04eecb86252e644a73f38346274340dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59c9030d87b24c9cb4efdabe9c7b9337"><td class="memItemLeft" align="right" valign="top">NDIS_SPIN_LOCK&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a59c9030d87b24c9cb4efdabe9c7b9337">BufferLock</a></td></tr>
<tr class="memdesc:a59c9030d87b24c9cb4efdabe9c7b9337"><td class="mdescLeft">&#160;</td><td class="mdescRight">It protects the buffer associated with this CPU.  <a href="#a59c9030d87b24c9cb4efdabe9c7b9337">More...</a><br /></td></tr>
<tr class="separator:a59c9030d87b24c9cb4efdabe9c7b9337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae03ade5065032ceaeef0bd03217b4f"><td class="memItemLeft" align="right" valign="top">PMDL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#acae03ade5065032ceaeef0bd03217b4f">TransferMdl1</a></td></tr>
<tr class="memdesc:acae03ade5065032ceaeef0bd03217b4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">MDL used to map the portion of the buffer that will contain an incoming packet.  <a href="#acae03ade5065032ceaeef0bd03217b4f">More...</a><br /></td></tr>
<tr class="separator:acae03ade5065032ceaeef0bd03217b4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17b59e156d00ef5c76bdfe454c73ca49"><td class="memItemLeft" align="right" valign="top">PMDL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a17b59e156d00ef5c76bdfe454c73ca49">TransferMdl2</a></td></tr>
<tr class="memdesc:a17b59e156d00ef5c76bdfe454c73ca49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second MDL used to map the portion of the buffer that will contain an incoming packet.  <a href="#a17b59e156d00ef5c76bdfe454c73ca49">More...</a><br /></td></tr>
<tr class="separator:a17b59e156d00ef5c76bdfe454c73ca49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58f2c915dfc7041ccb0d568eb79b494e"><td class="memItemLeft" align="right" valign="top">ULONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____CPU__Private__Data.html#a58f2c915dfc7041ccb0d568eb79b494e">NewP</a></td></tr>
<tr class="memdesc:a58f2c915dfc7041ccb0d568eb79b494e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by NdisTransferData() (when we call NdisTransferData, p index must be updated only in the TransferDataComplete.  <a href="#a58f2c915dfc7041ccb0d568eb79b494e">More...</a><br /></td></tr>
<tr class="separator:a58f2c915dfc7041ccb0d568eb79b494e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Kernel buffer of each CPU. </p>
<p>Structure containing the kernel buffer (and other CPU related fields) used to capture packets. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00207">207</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a class="anchor" id="ac723ebbda9ff2ef8e4d773c7305db1f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG Accepted</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of packet that current capture instance acepted, from its opening. A packet is accepted if it passes the filter and fits in the buffer. Accepted packets are the ones that reach the application. This number is related to the particular CPU this structure is referring to. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00213">213</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7ed9f5e612c567cfa25af0f46a25dad4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PUCHAR Buffer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to the kernel buffer used to capture packets. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00212">212</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a59c9030d87b24c9cb4efdabe9c7b9337"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NDIS_SPIN_LOCK BufferLock</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It protects the buffer associated with this CPU. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00225">225</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2df61425b58c12f1de6f0e6aaeb131ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG C</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zero-based index of the consumer in the buffer. It indicates the first free byte to be read. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00210">210</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a04eecb86252e644a73f38346274340dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG Dropped</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of packet that current instance had to drop, from its opening. A packet is dropped if there is no more space to store it in the circular buffer that the driver associates to current instance. This number is related to the particular CPU this structure is referring to. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00221">221</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="acaf5ef1e959170b06d01fc65a27bb951"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG Free</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of the free bytes in the buffer. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00211">211</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a58f2c915dfc7041ccb0d568eb79b494e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG NewP</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used by NdisTransferData() (when we call NdisTransferData, p index must be updated only in the TransferDataComplete. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00228">228</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a897d2179904e0d6fafd73b3d400052de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG P</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zero-based index of the producer in the buffer. It indicates the first free byte to be written. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00209">209</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a82febc79f3f3bbf857a4fd34447b5ca2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG Received</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of packets received by current instance from its opening, i.e. number of packet received by the network adapter since the beginning of the capture/monitoring/dump session. This number is related to the particular CPU this structure is referring to. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00217">217</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="acae03ade5065032ceaeef0bd03217b4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PMDL TransferMdl1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MDL used to map the portion of the buffer that will contain an incoming packet. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00226">226</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<a class="anchor" id="a17b59e156d00ef5c76bdfe454c73ca49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PMDL TransferMdl2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Second MDL used to map the portion of the buffer that will contain an incoming packet. </p>

<p>Definition at line <a class="el" href="Packet_8h_source.html#l00227">227</a> of file <a class="el" href="Packet_8h_source.html">Packet.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="Packet_8h_source.html">Packet.h</a></li>
</ul>
</div><!-- contents -->

<hr>
<p align="right"><img border="0" src="winpcap_small.gif" align="absbottom" width="91" height="27">
documentation. Copyright (c) 2002-2005 Politecnico di Torino. Copyright (c) 2005-2010
CACE Technologies. Copyright (c) 2010-2013
Riverbed Technology. All rights reserved.</p>
